# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# Описанме

В проекте применен принцип MVP (Model-View-Presenter), который обеспечивает четкое разделение ответственностей между классами Model и View каждый класс выполняет свою определенную роль:

- **Model (Модель)**: работает с данными, выполняет бизнес-логику и управляет состоянием приложения.
- **View (Представление)**: отвечает за отображение данных пользователю и обработку взаимодействий.
- **Presenter (Представитель)**: связывает Model и View, обрабатывает события и координирует взаимодействие между слоями.

## Функции основных частей

- **Model**: хранит и обрабатывает данные приложения, взаимодействует с сервером.
- **View**: отображает данные, предоставляет интерфейс для взаимодействия с пользователем.
- **Presenter**: реагирует на действия пользователя, обновляет модель и инициирует обновление представления.

## Взаимодействие частей

1. Пользователь взаимодействует с **View** (например, кликает на элемент).
2. **View** генерирует событие и передаёт его **Presenter** через `EventEmitter`.
3. **Presenter** вызывает методы **Model** для изменения данных.
4. **Model** обновляет данные и генерирует событие через `EventEmitter`.
5. **Presenter** обрабатывает событие, запрашивает обновлённые данные из **Model** и вызывает методы **View** для обновления интерфейса.

---

## Компоненты приложения

### Слой Model

#### Класс `AppData`
**Назначение**: управление данными приложения, работа с данными сервера и локальными данными.

**Конструктор**: принимает объект конфигурации с параметрами сервера.

**Методы**:
- `getProducts()`: получает список товаров с сервера.
- `getProductDetails(id: number)`: получает данные о конкретном товаре.
- `addToBasket(productId: number)`: добавляет товар в корзину.
- `removeFromBasket(productId: number)`: удаляет товар из корзины.
- `submitOrder(orderData: OrderData)`: отправляет данные заказа на сервер.

---

### Слой View

#### Базовый класс `Component`
**Назначение**: базовый класс для всех компонентов представления.

**Методы**:
- `render()`: отрисовка компонента.
- `bindEvents()`: привязка обработчиков событий.

#### Классы, наследуемые от `Component`:
- **`Modal`**: управление отображением модальных окон.
  - `open(content: HTMLElement)`: открывает модальное окно с указанным контентом.
  - `close()`: закрывает модальное окно.
  
- **`Basket`**: отображение корзины товаров.
  - `renderBasketItems(items: Product[])`: отображает список товаров в корзине.
  - `updateTotalPrice(price: number)`: обновляет общую стоимость.

- **`Form`**: отображение формы оплаты.
  - `validateInputs()`: проверяет корректность заполнения полей.
  - `submitForm()`: отправляет данные формы.

- **`Success`**: отображение успешного завершения заказа.
  - `showSuccessMessage(message: string)`: отображает сообщение об успехе.

- **`Page`**: управление содержимым страницы.
  - `renderPageContent(content: HTMLElement)`: отображает основной контент страницы.

- **`Card`**: отображение карточки товара.
  - `setProductDetails(details: Product)`: задаёт данные товара.

- **`Order`**: управление отображением формы заказа.
  - `setOrderDetails(order: Order)`: задаёт данные заказа.

- **`Contacts`**: управление отображением полей для контактных данных.
  - `validateContacts(data: ContactData)`: проверяет корректность контактной информации.

---

### Слой Presenter

#### Класс `EventEmitter`
**Назначение**: брокер событий, реализующий паттерн **Observer**.

**Методы**:
- `on(event: string, listener: Function)`: подписка на событие.
- `off(event: string, listener: Function)`: отписка от события.
- `emit(event: string, data?: any)`: генерация события.

---

## Пример взаимодействия компонентов

**Сценарий: добавление товара в корзину**

1. Пользователь кликает на кнопку "Купить" в карточке товара (**View: Card**).
2. **Card** вызывает `emit('addToBasket', productId)` через `EventEmitter`.
3. **Presenter** обрабатывает событие, вызывает `addToBasket(productId)` в **AppData (Model)**.
4. **AppData** обновляет список товаров в корзине и генерирует событие `basketUpdated`.
5. **Presenter** обрабатывает событие `basketUpdated`, вызывает `renderBasketItems` в **Basket (View)**.
6. **Basket** обновляет отображение списка товаров в корзине.

---

## Данные и типы

- **`Product`**: описание товара.
  - **Поля**: `id`, `name`, `description`, `price`, `category`, `imageUrl`.
  - **Используется в**: `AppData`, `Card`, `Basket`.

- **`OrderData`**: данные заказа.
  - **Поля**: `products: Product[]`, `address: string`, `paymentMethod: string`.
  - **Используется в**: `AppData`, `Form`.

- **`ContactData`**: контактные данные пользователя.
  - **Поля**: `email: string`, `phone: string`.
  - **Используется в**: `Contacts`.

---

## Реализация процессов через события

- **Добавление товара в корзину**:
  - **Событие**: `addToBasket`.
  - **Источник**: `Card`.
  - **Обработчик**: `AppData.addToBasket` через **Presenter**.

- **Обновление корзины**:
  - **Событие**: `basketUpdated`.
  - **Источник**: `AppData`.
  - **Обработчик**: `Basket.renderBasketItems` через **Presenter**.
